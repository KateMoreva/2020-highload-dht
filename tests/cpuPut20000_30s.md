-t1 -c1 -d30s -R20000 -s ./wrk/put.lua --latency http://localhost:8080
Running 30s test @ http://localhost:8080
  1 threads and 1 connections
  Thread calibration: mean lat.: 339.973ms, rate sampling interval: 2619ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   182.50ms  427.46ms   1.88s    87.73%
    Req/Sec    20.01k     6.77k   32.67k    71.43%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%   11.34ms
 75.000%   40.29ms
 90.000%  851.46ms
 99.000%    1.78s 
 99.900%    1.87s 
 99.990%    1.88s 
 99.999%    1.88s 
100.000%    1.88s 

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.021     0.000000           12         1.00
       0.636     0.100000        39906         1.11
       1.356     0.200000        79802         1.25
       3.427     0.300000       119726         1.43
       6.311     0.400000       159607         1.67
      11.335     0.500000       199477         2.00
      14.551     0.550000       219431         2.22
      18.479     0.600000       239370         2.50
      23.551     0.650000       259302         2.86
      29.759     0.700000       279264         3.33
      40.287     0.750000       299200         4.00
      47.199     0.775000       309184         4.44
      58.591     0.800000       319133         5.00
      91.519     0.825000       329114         5.71
     320.767     0.850000       339085         6.67
     585.215     0.875000       349051         8.00
     718.335     0.887500       354051         8.89
     851.455     0.900000       359034        10.00
     982.015     0.912500       364013        11.43
    1112.063     0.925000       369024        13.33
    1241.087     0.937500       373983        16.00
    1305.599     0.943750       376486        17.78
    1370.111     0.950000       379008        20.00
    1434.623     0.956250       381472        22.86
    1501.183     0.962500       383990        26.67
    1566.719     0.968750       386463        32.00
    1600.511     0.971875       387712        35.56
    1624.063     0.975000       388967        40.00
    1655.807     0.978125       390188        45.71
    1688.575     0.981250       391458        53.33
    1721.343     0.984375       392705        64.00
    1737.727     0.985938       393310        71.11
    1754.111     0.987500       393939        80.00
    1771.519     0.989062       394581        91.43
    1787.903     0.990625       395187       106.67
    1804.287     0.992188       395805       128.00
    1812.479     0.992969       396114       142.22
    1820.671     0.993750       396421       160.00
    1829.887     0.994531       396772       182.86
    1837.055     0.995313       397052       213.33
    1845.247     0.996094       397357       256.00
    1849.343     0.996484       397512       284.44
    1853.439     0.996875       397674       320.00
    1857.535     0.997266       397829       365.71
    1861.631     0.997656       397982       426.67
    1865.727     0.998047       398136       512.00
    1867.775     0.998242       398218       568.89
    1869.823     0.998437       398294       640.00
    1871.871     0.998633       398445       731.43
    1872.895     0.998828       398519       853.33
    1873.919     0.999023       398594      1024.00
    1873.919     0.999121       398594      1137.78
    1874.943     0.999219       398671      1280.00
    1874.943     0.999316       398671      1462.86
    1875.967     0.999414       398744      1706.67
    1875.967     0.999512       398744      2048.00
    1875.967     0.999561       398744      2275.56
    1876.991     0.999609       398821      2560.00
    1876.991     0.999658       398821      2925.71
    1876.991     0.999707       398821      3413.33
    1876.991     0.999756       398821      4096.00
    1878.015     0.999780       398905      4551.11
    1878.015     0.999805       398905      5120.00
    1878.015     0.999829       398905      5851.43
    1878.015     0.999854       398905      6826.67
    1878.015     0.999878       398905      8192.00
    1878.015     0.999890       398905      9102.22
    1878.015     0.999902       398905     10240.00
    1878.015     0.999915       398905     11702.86
    1878.015     0.999927       398905     13653.33
    1878.015     0.999939       398905     16384.00
    1878.015     0.999945       398905     18204.44
    1878.015     0.999951       398905     20480.00
    1878.015     0.999957       398905     23405.71
    1878.015     0.999963       398905     27306.67
    1878.015     0.999969       398905     32768.00
    1878.015     0.999973       398905     36408.89
    1878.015     0.999976       398905     40960.00
    1879.039     0.999979       398914     46811.43
    1879.039     1.000000       398914          inf
#[Mean    =      182.501, StdDeviation   =      427.461]
#[Max     =     1878.016, Total count    =       398914]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  598946 requests in 30.00s, 38.27MB read
Requests/sec:  19965.18
Transfer/sec:      1.28MB

Обработка http запроса 72.08%
Запись в сокет 29.94%
Чтение из сокета 9.55%
DAO upsert 26.82%
DAO flush 22.05%

Flush не асинхронный, из-за блокировки запросов перед записью на диск возрастает время отклика, от сюда плохое stdev.
